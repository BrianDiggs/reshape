p <- function(x) cast_parse_formula(x, letters[1:5])
unc <- function(...) {
  dots <- list(...)
  lapply(dots, unclass)
}

test_parse_1d <- function() {
  checkEquals(p(a ~ .)$m, unc(.(a), list()))
  checkEquals(p(. ~ a)$m, unc(list(), .(a)))
}

test_parse_2d <- function() {  
  checkEquals(p(a ~ b)$m, unc(.(a), .(b)))
  checkEquals(p(a ~ ...)$m, unc(.(a), .(b, c, d, e)))
  checkEquals(p(a ~ ... + b)$m, unc(.(a), .(c, d, e, b)))
  checkEquals(p(a ~ -b)$m, unc(.(a), .(c, d, e)))
  checkEquals(p(a ~ -(b + e))$m, unc(.(a), .(c, d)))
}

test_parse_mored <- function() {
  checkEquals(p(a ~ b ~ c)$m, unc(.(a), .(b), .(c)))
  checkEquals(p(a ~ b ~ c ~ ...)$m, unc(.(a), .(b), .(c), .(d, e)))  
}